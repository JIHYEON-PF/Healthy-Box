<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta name="description" content="">
    <meta name="author" content="JH">
    <title>Healthy Box</title>

    <!-- BootStrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>

    <link href="/css/colors.css" rel="stylesheet">
    <link href="/css/compProperties.css" rel="stylesheet">
    <link href="/css/orderDetailCss.css" rel="stylesheet">
    <link href="/css/header.css" rel="stylesheet">

</head>
<body>

    <header id="header">
        헤더 삽입부
        <hr>
    </header>

    <main class="container border-top">
        <div class="d-flex flex-wrap">
            <div id="myPageNav">
                마이페이지 메뉴 부분
            </div>
            <div class="col bg-light d-flex align-items-center justify-content-center">
                <div id="myPageDiv" class="container py-3">
                    <div class="defaultFontStyle borderBottom py-2">
                        <span class="fs-5">주문 정보</span>
                    </div>

                    <div class="defaultFontColor pt-4">
                        <span id="orderItemSpan" class="fs-5">주문목록</span>
                        <table id="orderItemList">
                            <thead>
                                <tr id="orderItemListBodyHead">
                                    <th class="orderItemOrderNo" hidden>주문번호</th>
                                    <th class="orderItemOrderIdx" hidden>주문 일렬번호</th>
                                    <th class="orderItemImage">이미지</th>
                                    <th class="orderItemName">
                                        품명
                                        <hr class="tableDivide">
                                        배송정보
                                    </th>
                                    <th class="orderItemDeliveryDate">수량</th>
                                    <th class="orderItemUnitCost">단가</th>
                                    <th class="orderItemDcCost">할인금액</th>
                                    <th class="orderItemAmount">총금액</th>
                                </tr>
                            </thead>
                            <tbody id="orderItemListBody">
                                <tr class="orderItemListBodyContent">
                                    <td class="orderDateSectOrderNo" hidden></td>
                                    <td class="orderDateSectOrderIdx" hidden></td>
                                    <td class="orderItemImage"><img src="/image/products/00000.jpg" alt="품목이미지"></td>
                                    <td class="orderItemNameAndDeliveryInform">
                                        <label class="orderItemName">테스트 상품</label>
                                        <hr class="tableDivide">
                                        <label class="deliveryCompData DataSect">택배</label>
                                        <a href="#" class="deliveryCodeData DataSect">0000000000</a>
                                        <label class="deliveryStatus" hidden>배송상태</label>
                                        <label class="orderItemDeliveryDetailDate mb-1">2022-10-15</label>
                                    </td>
                                    <td class="orderItemQty">1</td>
                                    <td class="orderItemUnitCost">100,000 원</td>
                                    <td class="orderItemDcCost">0 원</td>
                                    <td class="orderItemAmount">100,000 원</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div id="paymentDiv" class="defaultFontColor py-4">
                        <span id="paymentSpan" class="fs-5">결제 금액</span>
                        <table id="paymentTable">
                            <thead>
                                <tr id="paymentNameSect">
                                    <th id="paymentTotalAmount">총 결제 금액</th>
                                    <th id="paymentDeliveredCost">배송 완료 제품 총액</th>
                                    <th id="paymentRevocableCost">취소·환불 가능 금액</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr id="paymentDateSect">
                                    <td id="paymentDataSectTotalAmount">10000</td>
                                    <td id="paymentDataSectDeliveredCost">10000</td>
                                    <td id="paymentDataSectRevocableCost">10000</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <table id="changeStatusTable">
                        <tbody>
                        <tr>
                            <td>
                                <label for="changeStatusOptions" class="nameSect defaultFontStyle">분류</label>
                                <label id="orderStatus" hidden>주문 상태</label>
                            </td>
                            <td>
                                <select id="changeStatusOptions" name="options" class="dataSect">
                                    <option value="none">=== 선택 ===</option>
                                    <option value="cancel">주문 취소</option>
                                    <option value="exchange">제품 교환</option>
                                    <option value="return">제품 반품</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label for="changeStatusTitle" class="nameSect defaultFontStyle">제목</label>
                            </td>
                            <td>
                                <input id="changeStatusTitle" class="dataSect" type="text" placeholder="제목을 입력해주세요." style="width: 500px;">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label for="changeStatusContent" class="nameSect defaultFontStyle">내용</label>
                            </td>
                            <td>
                                <textarea id="changeStatusContent" class="dataSect" placeholder="내용을 입력해주세요." style="height: 300px; width: 500px;"></textarea>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <div id="buttons" class="pt-5 pb-2">
                        <div class="d-flex flex-warp justify-content-center align-items-center">
                            <button type="button" id="changeSubscribeStatusDetail" class="orderDetailBtn1 mx-2">확인</button>
                            <button type="button" id="toOrderDetail" class="orderDetailBtn2 mx-2" onclick="location.href='javascript:history.back()'">취소</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer id="footer">
        <hr>
        푸터 삽입부
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>

    <script src="/js/myPage.js"></script>
    <script src="/js/order.js"></script>
    <script src="/js/header.js"></script>

    <script>
        $(document).ready(function () {
            let amount = 0;
            let deliveredCost = 0;
            let revocableCost = 0;
            $('.orderItemNameAndDeliveryInform').each(function () {
                let code = $(this).closest('td').find('.deliveryCompData').attr('value');
                let LogisticName = '';
                switch (code) {
                    case '01':
                        LogisticName = '우체국택배';
                        break;
                    case '04':
                        LogisticName = 'CJ대한통운';
                        break;
                    case '05':
                        LogisticName = '한진택배';
                        break;
                    case '06':
                        LogisticName = '로젠택배';
                        break;
                    case '08':
                        LogisticName = '롯데택배';
                        break;
                }
                $(this).closest('td').find('.deliveryCompData').text(LogisticName);

                amount += Number($(this).closest('tr').find('.orderItemAmount').attr('value'));
                if ($(this).closest('td').find('.deliveryStatus').text() !== '주문') {
                    deliveredCost += Number($(this).closest('tr').find('.orderItemAmount').attr('value'));
                } else {
                    revocableCost += Number($(this).closest('tr').find('.orderItemAmount').attr('value'));
                }
            });
            $('#paymentDataSectTotalAmount').text(String(amount).replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,') + ' 원').attr('value', amount);
            $('#paymentDataSectDeliveredCost').text(String(deliveredCost).replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,') + ' 원').attr('value', deliveredCost);
            $('#paymentDataSectRevocableCost').text(String(revocableCost).replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,') + ' 원').attr('value', revocableCost);
        });
    </script>
</body>
</html>
